/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var b=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var F=Object.prototype.hasOwnProperty;var I=(s,i)=>{for(var n in i)b(s,n,{get:i[n],enumerable:!0})},T=(s,i,n,e)=>{if(i&&typeof i=="object"||typeof i=="function")for(let t of C(i))!F.call(s,t)&&t!==n&&b(s,t,{get:()=>i[t],enumerable:!(e=x(i,t))||e.enumerable});return s};var P=s=>T(b({},"__esModule",{value:!0}),s);var j={};I(j,{default:()=>k});module.exports=P(j);var u=require("obsidian");var p=require("obsidian"),f=class extends p.PluginSettingTab{constructor(n,e){super(n,e);this.plugin=e}display(){let{containerEl:n}=this;n.empty(),n.createEl("h2",{text:"Settings"}),new p.Setting(n).setName("Anthropic API Key").setDesc("Won`t leave your vault").addText(e=>e.setPlaceholder("Enter your key").setValue(this.plugin.settings.anthropicKey).onChange(async t=>{this.plugin.settings.anthropicKey=t,await this.plugin.saveSettings()}))}};var v={anthropicKey:""};var w=require("obsidian");var h={generate_dictionary_entry:`You are the expert-linguist in German language. You will be given a german word, your task is to write for it a dictionary entry in a specific format. The comments in <...> are for you and are not part of the template.

For Trennbar verb use:

'''
<pick appropriate emoji for this word>[[anrufen]] + Akk, [\u02C8anru\u02D0fn\u0329]
[[rief an|rief an]]  
haben [[angerufen]]

---

---
Synonyme: [[telefonieren]], [[kontaktieren]], [[anklingeln]], [[durchklingeln]], [[w\xE4hlen]]
Antonyme: [[auflegen]], [[ignorieren]], [[schweigen]]

---
\xDCbersetzung: to call (on the phone)

---
Morpheme: [[an]][[ruf]][[en]]
 #Verb  #Trennbar
 

| Person | Pr\xE4sens | Pr\xE4teritum | Imperativ | Konjunktiv I | Konjunktiv II |
| --------- | ------------------- | --------------------- | --------------------------- | --------------------- | ----------------------- |
| Ich | [[rufe an]] | [[rief an]] | - | [[rufe an]] | [[riefe an]] |
| Du | [[rufst an]] | [[riefst an]] | [[ruf an]] | [[rufest an]] | [[riefest an]] |
| Er/sie/es | [[ruft an]] | [[rief an]] | - | [[rufe an]] | [[riefe an]] |
| Wir | [[rufen an]] | [[riefen an]] | - | [[rufen an]] | [[riefen an]] |
| Ihr | [[ruft an]] | [[rieft an]] | [[ruft an]] | [[rufet an]] | [[riefet an]] |
| Sie | [[rufen an]] | [[riefen an]] | [[rufen Sie an]] | [[rufen an]] | [[riefen an]] |

Partizip I: [[anrufend]], Partizip II: [[angerufen]]
[[anrufen]] - [[an]] = [[rufen]]
'''


For Untrennbares verbs and verbs without prefixis, use: 
'''
<pick appropriate emoji for this word>[[bekommen]] + Akk, [b\u0259\u02C8k\u0254m\u0259n]
[[bekam]]
haben [[bekommen]]

---

---
Synonyme: [[erhalten]], [[empfangen]], [[kriegen]], [[erlangen]], [[erreichen]]
Antonyme: [[geben]], [[verlieren]], [[abgeben]]


---
\xDCbersetzung: to get, to receive


---
Morpheme: [[be]][[komm]][[en]]
 #Verb  #Untrennbar

---

| Person    | Pr\xE4sens              | Pr\xE4teritum            | Imperativ         | Konjunktiv I           | Konjunktiv II           |
| --------- | -------------------- | --------------------- | ----------------- | ---------------------- | ----------------------- |
| Ich       | [[bekomme]]          | [[bekam]]             | -                 | [[bekomme]]            | [[bek\xE4me]]              |
| Du        | [[bekommst]]         | [[bekamst]]           | [[bekomm]]        | [[bekommest]]          | [[bek\xE4mest]]            |
| Er/sie/es | [[bekommt]]          | [[bekam]]             | -                 | [[bekomme]]            | [[bek\xE4me]]              |
| Wir       | [[bekommen]]         | [[bekamen]]           | -                 | [[bekommen]]           | [[bek\xE4men]]             |
| Ihr       | [[bekommt]]          | [[bekamt]]            | [[bekommt]]       | [[bekommet]]           | [[bek\xE4met]]             |
| Sie       | [[bekommen]]         | [[bekamen]]           | [[bekommen Sie]]  | [[bekommen]]           | [[bek\xE4men]]             |

Partizip I: [[bekommend]], Partizip II: [[bekommen]], Zu infinitive: anzurufen

[[bekommen]] - [[be]] = [[kommen]]
'''

For adjectives use:

'''
klein, [\u02C8kla\u026A\u032Fn]
nicht [[gro\xDF]]

---


---
Synonyme: [[winzig]], [[gering]], [[minimal]], [[unbedeutend]], [[bescheiden]]
Antonyme: [[gro\xDF]], [[riesig]], [[hoch]], [[weit]], [[lang]]

---
**\xDCbersetzung**:
small, little

---
#Adjective [[klein]]


Einzigartige m\xF6gliche Formen: 
[[klein]], [[kleiner]], [[kleine]], [[kleines]], [[kleinen]], [[kleinem]], [[kleiner]], [[kleinen]]
[[kleiner]], [[kleinerer]], [[kleinere]], [[kleineres]], [[kleineren]], [[kleinerem]], [[kleinerer]], [[kleineren]]
[[kleinsten]], [[kleinster]], [[kleinste]], [[kleinstes]], [[kleinsten]], [[kleinstem]], [[kleinster]], [[kleinsten]]
'''

For nouns, use the template below. For feminin words, use \u{1F534}, for neutral use \u{1F7E2}, for Maskulin use \u{1F535}
'''
\u{1F535} der [[Busch]], [\u02C8b\u028A\u0283]
die [[B\xFCsche]]


---


---
Synonyme:
- [[Strauch]], [[Geb\xFCsch]], [[Hecke]]

---
\xDCbersetzung: bush, shrub

---
Morpheme:
[[Busch]]

---
Einzigartige m\xF6gliche Formen: [[Hauses]], [[Hause]], [[H\xE4user]], [[H\xE4usern]]

---
#Substantiv #Maskulin
'''

for other parts of speech, come up with a simmilar template and fill it in.

Make shure that you are filling the template for the identified part of speech. 
Make shure that you are filling the template for the prosessed word.`,determine_infinitive_and_pick_emoji:`Given a german word, determine its infinitive form and pick an appropriate emoji to represent it. If the word is a noun, determin it's gender and use \u{1F535} for der,  \u{1F534} for die, if \u{1F7E2} for das. Do not write anything else, just the infinitive and an emoji. given "brutzelt"   "\u{1F373}[[brutzeln]]". Given "gesorgt" reply with "\u{1F914} [[sorgen]]". Given "Hoffnungen" reply with "\u{1F91E} \u{1F534} die [[Hoffnung]]. Given "eisigen", reply with "\u{1F976} [[eisig]]. I a word can be a form of multiple parts of speach, list all options, separated with |. For expample, given "vergangene", reply with "\u{1F570}\uFE0F, [[vergangen]] | \u{1F570}\uFE0F, [[vergehen]]. Given "Nieser", reply with "\u{1F927} [[niesen]] | \u{1F535} \u{1F927} der [[Nieser]]. Gigen "klares", reply with "\u{1F60C} [[kl\xE4ren]] | \u{1F60C} [[klar]] | \u{1F60C} \u{1F7E2} das [[Klare]]"`,make_brackets:`Process the given German text and generate output following these rules:

For verbs:
a. If the verb is in its basic form (infinitive), enclose it in double square brackets: [[infinitive]]
b. If the verb is not in its basic form, use this format: [[infinitive|encountered form]]
b. If the verb is trenbarren, add the prefix to the infinitive: [[prefixed infinitive|encountered form]]
For nouns:
a. If the noun is singular, enclose it in double square brackets: [[singular form]]
b. If the noun is plural, use this format: [[singular form|plural form]]
For adjectives:
a. If the adjective is in its basic form, enclose it in double square brackets: [[basic form]]
b. If the adjective is not in its basic form, use this format: [[basic form|encountered form]]
Ignore haben/sein, articles (definite and indefinite), names, proper nouns and pronomen

<example>
Der flei\xDFige Student f\xE4ngt an, das schwierige Buch zu lesen, das sein Lehrer empfohlen hat.
Der [[flei\xDFig|flei\xDFige]] [[Student]] [[anfangen|f\xE4ngt]] an, das [[schwierig|schwierige]] [[Buch]] zu [[lesen]], das sein [[Lehrer]] [[empfehlen|empfohlen]] hat.
</example>

<example>
(Schubst Sokka weg)\xA0Genau, er ist bestimmt ein Spion der Feuermarine! Das sieht man schon an dem furchtbar b\xF6sen Blick in seinen Augen!
([[wegschubsen|Schubst]] [[schubsen|Sokka]] weg) Genau, er ist [[bestimmt]] ein [[Spion]] der [[Feuermarine]]! Das [[sehen|sieht]] man [[schon]] an dem [[furchtbar|furchtbare]] [[b\xF6se|b\xF6sen]] [[Blick]] in seinen [[Auge|Augen]]!
</example>

<example>
Keine Angst. Mit Wasser kriegt man das wieder ab. Und, wohnt ihr hier in der Gegend?
Keine [[Angst]]. Mit [[Wasser]] [[abkriegen|kriegt]] man das wieder ab. Und, [[wohnen|wohnt]] ihr hier in der [[Gegend]]?
</example>

<example>
und ri\xDF ihnen die Fl\xFCgel aus.  
und [[ausrei\xDFen|ri\xDF]] ihnen die [[Fl\xFCgel]] aus.
</example>

<example>
Er schlug die St\xFChl und V\xF6gel tot,  
Er [[totschlagen|schlug]] die [[Stuhl|St\xFChl]] und [[Vogel|V\xF6gel]] tot,
<example>
</example>

<example>
So hab ich mich schon fr\xFCh gezwungen  
So hab ich mich [[schon]] [[fr\xFCh]] [[zwingen|gezwungen]]
<example>


The output should only contain the processed text, without explanations or additional content. Ensure grammatical accuracy in the final output.
`,translate_text:`Translate the given German text to English. The translation should be staying true to the original meaning. When possible, mimic german sentance structure. Only provide the translation, no explanations or additional content.

<example>
input:
Der flei\xDFige Student f\xE4ngt an, das schwierige Buch zu lesen.
output:
The diligent student begins the difficult book to read.
</example>

<example>
input:
Keine Angst. Mit Wasser kriegt man das wieder ab.
output:
No worry. With water can one wash it off.
</example>`};var g=class{constructor(i){this.settings=i}async fetchTemplate(i){return this.makeRequest(i,h.generate_dictionary_entry)}async determineInfinitiveAndEmoji(i){return this.makeRequest(i,h.determine_infinitive_and_pick_emoji)}async makeBrackets(i){return this.makeRequest(i,h.make_brackets)}async translateText(i){return this.makeRequest(i,h.translate_text)}async makeRequest(i,n){let e="https://api.anthropic.com/v1/messages",t={"Content-Type":"application/json","x-api-key":this.settings.anthropicKey,"anthropic-version":"2023-06-01","anthropic-beta":"prompt-caching-2024-07-31"},a={model:"claude-3-5-haiku-latest",max_tokens:1024,system:[{type:"text",text:n,cache_control:{type:"ephemeral"}}],messages:[{role:"user",content:i}]};try{let r=await(0,w.requestUrl)({url:e,method:"POST",contentType:"application/json",body:JSON.stringify(a),headers:t});return JSON.stringify(r)}catch(r){return r+`

`+JSON.stringify({url:e,method:"POST",headers:t,body:a})}}};var m=require("obsidian"),d=class{constructor(i){this.vault=i}async appendToFile(i,n){let e=this.vault.getAbstractFileByPath(i);if(!e){try{await this.vault.create(i,n)}catch(t){new m.Notice(`Error creating file: ${t.message}`)}return}if(!(e instanceof m.TFile)){new m.Notice(`File ${i} does not exist or is not a valid file!`);return}try{let a=await this.vault.read(e)+n;await this.vault.modify(e,a)}catch(t){new m.Notice(`Error appending to file: ${t.message}`)}}async doesFileContainContent(i,n){let e=this.vault.getAbstractFileByPath(i);return!e||!(e instanceof m.TFile)?null:(await this.vault.read(e)).includes(n)}};var S=s=>{let i=s.split("[[").map(n=>n.replace(/\\/g,"").split("|")[0].split("]]")[0]);return i.shift(),i};var k=class extends u.Plugin{async onload(){await this.loadSettings(),this.apiService=new g(this.settings),this.fileService=new d(this.app.vault),this.addCommand({id:"backlink-all-to-current-file",name:"Add backlinks to the current file in all referenced files",editorCallback:async(n,e)=>{var o;let t=(o=e.file)==null?void 0:o.name;if(!t){new u.Notice("Current file is missing a title");return}let a=e.data,r=S(a);for(let l of r){let c=`Worter/${l}.md`,y=`[[${t.split(".")[0]}]]`;await this.fileService.doesFileContainContent(c,y)||await this.fileService.appendToFile(c,`, ${y}`)}}}),this.addCommand({id:"log-to-file",name:"dumps log to the current file",editorCallback:async(n,e)=>{var o,l;let t=(o=e.file)==null?void 0:o.name;if(!t){new u.Notice("Current file is missing a title");return}let a=await this.apiService.fetchTemplate(t),r=this.extractContentFromResponse(a);r&&((l=e==null?void 0:e.file)!=null&&l.path)&&await this.fileService.appendToFile(e.file.path,r)}}),this.addCommand({id:"get-infinitive-and-emoji",name:"Get infinitive form and emoji for current word",editorCallback:async(n,e)=>{var o,l;let t=(o=e.file)==null?void 0:o.name;if(!t){new u.Notice("Current file is missing a title");return}let a=await this.apiService.determineInfinitiveAndEmoji(t),r=this.extractContentFromResponse(a);r&&((l=e==null?void 0:e.file)!=null&&l.path)&&await this.fileService.appendToFile(e.file.path,r)}}),this.addCommand({id:"duplicate-selection",name:"Duplicate selected text and process with brackets",editorCallback:async n=>{let e=n.getSelection();if(e){let t=n.getCursor(),a=await this.apiService.makeBrackets(e),r=this.extractContentFromResponse(a);r&&(n.replaceSelection(e+`

`+r+`
`),n.setCursor({line:t.line,ch:t.ch+e.length}))}}}),this.addCommand({id:"translate-selection",name:"Translate selected text and show below",editorCallback:async n=>{let e=n.getSelection();if(e){let t=n.getCursor(),a=await this.apiService.translateText(e),r=this.extractContentFromResponse(a);r&&(n.replaceSelection(e+`

`+r+`
`),n.setCursor({line:t.line,ch:t.ch+e.length}))}}}),this.addSettingTab(new f(this.app,this))}async loadSettings(){this.settings=Object.assign({},v,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}extractContentFromResponse(n){var e,t,a,r,o,l;try{let c=JSON.parse(n);return((a=(t=(e=c==null?void 0:c.json)==null?void 0:e.content)==null?void 0:t[0])==null?void 0:a.text)||((l=(o=(r=c==null?void 0:c.json)==null?void 0:r.content)==null?void 0:o[0])==null?void 0:l.text)||""}catch(c){return""}}};
